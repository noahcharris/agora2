var
//cr = require('../lib/crashreporter'),
domain = require('domain'),
fs = require('fs'),
util = require('util'),
d = domain.create();
d.on('error', function(er) {
	console.error('Caught error!', er);
	console.error('stack: ', er.stack);
	
	//console.error('Domain: ', er.domain);
	//util.inspect(er, true, 100);
});
d.run(function() {
  process.nextTick(function() {
	setTimeout(function() { // simulating some various async stuff
	  fs.open('non-existent file', 'r', function(er, fd) {
		if (er) {
			throw er;
		}
		//throw new Error('foo');
	  });
	}, 100);
  });
});