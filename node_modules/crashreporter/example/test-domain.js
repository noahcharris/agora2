var assert = require('assert');
var domain = require('domain');
var events = require('events');

var a = domain.create();
a.name = 'a';

a.on('error', function(er) {
	console.log(er.stack);
});

var foo = a.bind(function() {
  throw new Error('error from foo');
});

process.nextTick(foo);